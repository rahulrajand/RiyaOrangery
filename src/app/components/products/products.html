<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Product",
    "name": "{{ product_detail.productname }}",
    "image": {{ product_detail.productimg | json }},
    "description": "{{ product_detail.shortDescription }}",
    "brand": {
      "@type": "Brand",
      "name": "Riya Orangery"
    },
    "offers": {
      "@type": "Offer",
      "priceCurrency": "INR",
      "price": "{{ product_detail.productlowprice }}",
      "availability": "https://schema.org/{{ product_detail.stockAvailable ? 'InStock' : 'OutOfStock' }}"
    }
  }
</script>
<div class="wrapper">
  <div class="main">
    <div class="section">
      <div class="product-page container">
        <div class="product-main">
          <!-- LEFT: Image -->
          <div class="product-gallery">
            <!-- Back to Collection Link -->
            <a [routerLink]="['/collection', categoryForBackLink]" class="back-to-collection">
              <i class="fa fa-arrow-left"></i> Back to Collection
            </a>

            <!-- Main Product Image -->
            <div class="main-image">
              <ngb-carousel
                #carousel
                class="product-carousel"
                [interval]="0"
                [wrap]="true"
                [keyboard]="true"
                [showNavigationArrows]="true"
                [showNavigationIndicators]="false"
              >
                <ng-template
                  ngbSlide
                  *ngFor="let img of product_detail.productimg; let i = index"
                  [id]="'slide-' + i"
                >
                  <div class="carousel-image-wrapper">
                    <img
                      src="./img/Plants/400/{{ img }}"
                      srcset="./img/Plants/400/{{ img }} 400w, ./img/Plants/600/{{ img }} 600w, ./img/Plants/1200/{{ img }} 1200w"
                      sizes="(max-width: 768px) 100vw, 33vw"
                      loading="lazy"
                      alt="{{ product_detail.productname }} indoor plant image {{ i + 1 }}"
                    />
                  </div>
                </ng-template>
              </ngb-carousel>
            </div>

            <!-- Thumbnails -->
            <div class="thumbnails">
              <img
                *ngFor="let img of product_detail.productimg; let i = index"
                src="./img/Plants/400/{{ img }}"
                srcset="./img/Plants/400/{{ img }} 400w, ./img/Plants/600/{{ img }} 600w, ./img/Plants/1200/{{ img }} 1200w"
                sizes="(max-width: 768px) 100vw, 33vw"
                loading="lazy"
                (click)="selectImage(i)"
                class="thumb-img"
                alt="{{ product_detail.productname }} thumbnail {{ i + 1 }}"
              />
            </div>
          </div>

          <!-- RIGHT: Details -->
          <div class="product-details">
            <div class="product-badges">
              <span
                class="badge badge-out-of-stock"
                *ngIf="product_detail.stockAvailable === false"
              >
                <i class="fa fa-ban"></i> Out of Stock
              </span>
              <span
                class="badge badge-discount"
                *ngIf="product_detail.discount !== 0 && product_detail.stockAvailable !== false"
              >
                <i class="fa fa-tag"></i> {{ product_detail.discount }}% OFF
              </span>
            </div>

            <h1 class="product-title">{{ product_detail.productname }}</h1>
            <div class="product-scientific-name" *ngIf="product_detail.productsciname">
              <i class="fa fa-flask"></i> {{ product_detail.productsciname }}
            </div>
            <div class="product-label">
              <i class="fa fa-leaf"></i> {{ product_detail.productlabel }}
            </div>

            <div class="product-price-range">
              <span class="currency">‚Çπ</span>{{ product_detail.productlowprice }} -
              <span class="currency">‚Çπ</span>{{ product_detail.producthighprice }}
            </div>

            <p class="product-short-description">
              {{ product_detail.shortDescription }}
            </p>
            <div class="product-options" *ngIf="product_detail.stockAvailable === true">
              <div class="option-group">
                <label class="option-label">
                  <i class="fa fa-expand"></i> Plant Diameter
                  <span class="selected-value" *ngIf="diamet">: {{ this.diamet }}</span>
                </label>
                <div class="option-buttons">
                  <button
                    type="button"
                    class="option-btn"
                    [class.active]="diamet === diameter"
                    (click)="onDiameterClick($event)"
                    *ngFor="let diameter of diam"
                  >
                    {{ diameter }}
                  </button>
                </div>
              </div>

              <div class="option-group">
                <label class="option-label">
                  <i class="fa fa-clone"></i> Pot Diameter
                  <span class="selected-value" *ngIf="pots">: {{ this.pots }}</span>
                </label>
                <div class="option-buttons">
                  <button
                    type="button"
                    class="option-btn"
                    [class.active]="pots === pott"
                    (click)="onPotClick($event)"
                    *ngFor="let pott of pot"
                  >
                    {{ pott }}
                  </button>
                </div>
              </div>

              <div class="option-group">
                <label class="option-label">
                  <i class="fa fa-tint"></i> Soil Type
                  <span class="selected-value" *ngIf="soil">: {{ this.soil }}</span>
                </label>
                <div class="option-buttons">
                  <button
                    type="button"
                    class="option-btn"
                    [class.active]="soil === Soil"
                    (click)="onSoilClick($event)"
                    *ngFor="let Soil of Soil"
                  >
                    {{ Soil }}
                  </button>
                </div>
              </div>

              <div
                class="final-price"
                *ngIf="price_range !== 0 && product_detail.stockAvailable === true"
              >
                <div class="price-display">
                  <span class="price-label">Final Price:</span>
                  <div class="price-values">
                    <span class="original-price" *ngIf="product_detail.discount !== 0">
                      ‚Çπ{{ price_range }}
                    </span>
                    <span class="current-price">
                      ‚Çπ{{ product_detail.discount !== 0 ? price_range_updated : price_range }}
                    </span>
                  </div>
                </div>
              </div>
            </div>

            <div class="product-actions">
              <div class="quantity-selector" *ngIf="product_detail.stockAvailable === true">
                <label class="qty-label">Quantity</label>
                <input type="number" min="1" max="99" [(ngModel)]="quantity" class="qty-input" />
              </div>

              <div class="action-buttons">
                <button
                  class="btn-add-cart"
                  *ngIf="product_detail.stockAvailable === true"
                  (click)="AddtoCart(product_detail, $event)"
                >
                  <i class="fa fa-shopping-cart"></i> Add to Cart
                </button>
                <button
                  class="btn-wishlist"
                  (click)="toggleWishlist(product_detail, $event)"
                  [class.active]="product_detail.isWishlisted"
                >
                  <i
                    class="fa"
                    [ngClass]="product_detail.isWishlisted ? 'fa-heart' : 'fa-heart-o'"
                  ></i>
                  <span>{{ product_detail.isWishlisted ? 'Wishlisted' : 'Add to Wishlist' }}</span>
                </button>
              </div>
            </div>

            <div class="error-alert" *ngIf="errorMessage">
              <i class="fa fa-exclamation-circle"></i> {{ errorMessage }}
            </div>
          </div>
        </div>

        <!-- Tabs -->
        <ul ngbNav #nav="ngbNav" class="nav nav-tabs">
          <li [ngbNavItem]="1">
            <a ngbNavLink style="font-size: medium; font-weight: bold">Description</a>
            <ng-template ngbNavContent>
              <h2 style="font-size: medium">
                <p class="product-description">
                  {{ product_detail.description }}
                </p>
              </h2></ng-template
            >
          </li>
          <li [ngbNavItem]="2">
            <a ngbNavLink style="font-size: medium; font-weight: bold">Tips</a>
            <ng-template ngbNavContent>
              <h2 style="font-size: medium" *ngFor="let tip of product_detail.tips">
                <strong *ngIf="tip.includes(':')">{{ tip.split(':')[0] }}:</strong>
                <span *ngIf="!tip.includes(':')">{{ tip.split(':')[0] }} </span>
                {{ tip.split(':')[1] }}
              </h2>
            </ng-template>
          </li>
        </ul>

        <div [ngbNavOutlet]="nav" class="mt-2"></div>
      </div>
      <div class="container">
        <div class="" style="text-align: left">
          <h4 style="font-weight: 600">Disclaimer:</h4>
          <h5>
            Plant care information is for general informational purposes only. Specific needs may
            vary based on your local climate and growing conditions‚Ä¶!!! For all succulent And
            cactus..üëÜüèºüëÜüèº
          </h5>
        </div>
      </div>
    </div>
    <div class="section related-products-section" *ngIf="prod_detail && prod_detail.length > 0">
      <div class="container">
        <div class="section-header">
          <p class="section-subtitle">You May Also Like</p>
          <h2 class="section-title">Related Products</h2>
          <div class="title-underline"></div>
        </div>
      </div>
      <div class="container">
        <div class="front-display-section">
          <div class="product-card-wrapper" *ngFor="let prod of prod_detail">
            <div class="product-card" [routerLink]="['/Product', prod.productname]">
              <div class="product-image-wrapper">
                <img
                  class="product-image"
                  src="./img/Plants/400/{{ prod.productimg[0] }}"
                  srcset="./img/Plants/400/{{ prod.productimg[0] }} 400w, ./img/Plants/600/{{ prod.productimg[0] }} 600w, ./img/Plants/1200/{{ prod.productimg[0] }} 1200w"
                  sizes="(max-width: 768px) 100vw, 33vw"
                  loading="lazy"
                  alt="{{ prod.productname }} indoor plant"
                />
                <div class="stock-badge" *ngIf="prod.stockAvailable === false">
                  <i class="fa fa-ban"></i> Out of stock
                </div>
                <div
                  class="discount-badge"
                  *ngIf="prod.discount !== 0 && prod.stockAvailable !== false"
                >
                  <i class="fa fa-tag"></i> {{ prod.discount }}% OFF
                </div>
                <button class="wishlist-btn" (click)="toggleWishlist(prod, $event)">
                  <i class="fa" [ngClass]="prod.isWishlisted ? 'fa-heart' : 'fa-heart-o'"></i>
                </button>
              </div>
              <div class="product-details">
                <span class="product-category">{{ prod.productlabel }}</span>
                <h4 class="product-name">{{ prod.productname }}</h4>
                <div class="product-price">
                  <span class="price-currency">‚Çπ</span>{{ prod.productlowprice }} -
                  <span class="price-currency">‚Çπ</span>{{ prod.producthighprice }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
